# 3.5 레이블과 셀렉터를 이용해 파드 스케줄링 제한

생성일: 2021년 3월 20일 오전 4:04

현재까지 생성한 모든 파드 → 워커 노드 전체에 걸쳐 무작위로 스케줄링

- 쿠버네티스에서 파드가 어느 노드에 스케줄링 되었느냐는 중요치 않음 (모든 노드를 대규모 배포 플랫폼으로 노출하기 때문)
- 각 파드는 요청한 만큼 정확한 컴퓨팅 리소스를 할당받음

> 만약 파드를 스케줄링할 위치를 결정하고 싶은 경우?!

## 1. 워커노드 분류에 레이블 사용

파드 뿐만 아니라, 노드를 포함한 모든 쿠버네티스 오브젝트에 레이블을 부착할 수 있음

- 클러스터에 범용 GPU 컴퓨팅에 사용할 수 있는 GPU 노드가 있다고 가정

    ⇒ 해당 사항에 관한 레이블을 `노드`에 추가 

```bash
kubectl label node gke-kubia-default-pool-378e3d66-f4rr gpu=true
```

![3%205%20%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%87%E1%85%B3%E1%86%AF%E1%84%80%E1%85%AA%20%E1%84%89%E1%85%A6%E1%86%AF%E1%84%85%E1%85%A6%E1%86%A8%E1%84%90%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A2%20%E1%84%91%E1%85%A1%E1%84%83%E1%85%B3%20%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC%20%20312fe302e5784cfaa5c7ab1bedc9bcf4/_2021-03-20__4.15.38.png](3%205%20%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%87%E1%85%B3%E1%86%AF%E1%84%80%E1%85%AA%20%E1%84%89%E1%85%A6%E1%86%AF%E1%84%85%E1%85%A6%E1%86%A8%E1%84%90%E1%85%A5%E1%84%85%E1%85%B3%E1%86%AF%20%E1%84%8B%E1%85%B5%E1%84%8B%E1%85%AD%E1%86%BC%E1%84%92%E1%85%A2%20%E1%84%91%E1%85%A1%E1%84%83%E1%85%B3%20%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A6%E1%84%8C%E1%85%AE%E1%86%AF%E1%84%85%E1%85%B5%E1%86%BC%20%20312fe302e5784cfaa5c7ab1bedc9bcf4/_2021-03-20__4.15.38.png)

모든 노드를 나열하고 각 노드의 gpu 레이블 값을 보여주는 추가 열 표시하는것 가능

```bash
kubectl get nodes -L gpu
```

## 2. 특정 노드에 파드 스케줄링

gpu를 필요로 하는 새로운 파드를 배포해야할 때

⇒ 파드의 YAML 파일에 노드 셀렉터를 추가해서, 스케줄러가 GPU 제공 노드를 선택하도록 요청해야함

kubia-gpu.yaml

```bash
apiVersion: v1
kind: Pod
metadata:
  name: kubia-gpu
spec:
  nodeSelector:               // nodeSelector : 쿠버네티스에
    gpu: "true"               // gpu=true 레이블을 포함한 노드에 이 파드를 배포하도록 지시
  containers:
  - image: luksa/kubia
    name: kubia
```

vi 로 생성해따..

## 3. 하나의 특정 노드로 스케줄링

파드를 특정 노드로 스케줄링하는 것 가능

⇒ [kubernetes.io/hostname으로](http://kubernetes.io/hostname으로) 각 노드의 키를 설정

⇒ 값에는 호스트 이름이 설정

> 하지만, nodeSelector에 실제 호스트 이름을 지정할 경우, 해당 노드가 오프라인일때 파드가 스케줄링 되지 않을 수 있다.